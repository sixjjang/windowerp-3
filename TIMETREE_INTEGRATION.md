# 타임트리 연동 설정 가이드

## 개요

Windowerp-3 프로젝트에 타임트리 스케줄 프로그램 연동 기능이 추가되었습니다. 이를 통해 외부 일정과 동기화할 수 있습니다.

## 기능

- **양방향 동기화**: 로컬 일정 ↔ 타임트리 일정
- **단방향 동기화**: 로컬 → 타임트리 또는 타임트리 → 로컬
- **자동 동기화**: 설정한 간격으로 자동 동기화
- **수동 동기화**: 언제든지 수동으로 동기화 가능
- **캘린더 선택**: 타임트리에서 원하는 캘린더 선택

## 설정 방법

### 1. 타임트리 개발자 계정 설정

1. [타임트리 개발자 포털](https://timetreeapis.com)에 접속
2. 새 애플리케이션 생성
3. OAuth 설정에서 다음 정보 확인:
   - Client ID
   - Client Secret
   - Redirect URI: `http://localhost:3000/timetree-callback`

### 2. 환경 변수 설정

프로젝트 루트에 `.env` 파일을 생성하고 다음 내용을 추가:

```env
# 타임트리 OAuth 클라이언트 ID
REACT_APP_TIMETREE_CLIENT_ID=your_timetree_client_id_here

# 타임트리 OAuth 클라이언트 시크릿
REACT_APP_TIMETREE_CLIENT_SECRET=your_timetree_client_secret_here

# API 기본 URL (개발/운영 환경에 따라 설정)
REACT_APP_API_BASE_URL=http://localhost:3001
```

### 3. 애플리케이션 실행

```bash
npm start
```

## 사용 방법

### 1. 타임트리 인증

1. 스케줄 페이지에서 "타임트리 연동" 버튼 클릭
2. "인증하기" 버튼 클릭
3. 타임트리 로그인 및 권한 승인
4. 인증 완료 후 창 닫기

### 2. 연동 설정

1. **연동 활성화**: 타임트리 연동을 활성화합니다
2. **캘린더 선택**: 동기화할 타임트리 캘린더를 선택합니다
3. **동기화 방향 설정**:
   - 양방향 동기화: 로컬 ↔ 타임트리
   - 로컬 → 타임트리: 로컬 일정만 타임트리로 전송
   - 타임트리 → 로컬: 타임트리 일정만 로컬로 가져오기
4. **자동 동기화 설정** (선택사항):
   - 자동 동기화 활성화
   - 동기화 간격 설정 (5분 ~ 24시간)

### 3. 동기화 실행

- **수동 동기화**: "지금 동기화" 버튼 클릭
- **자동 동기화**: 설정한 간격으로 자동 실행

## 데이터 매핑

### 로컬 → 타임트리
- 제목: 일정 제목
- 시작 시간: 일정 시작 시간
- 종료 시간: 일정 종료 시간 (없으면 시작 시간 + 1시간)
- 설명: 일정 설명
- 위치: 일정 주소
- 시간대: Asia/Seoul

### 타임트리 → 로컬
- 제목: 타임트리 이벤트 제목
- 날짜: 타임트리 이벤트 시작 날짜
- 시작 시간: 타임트리 이벤트 시작 시간
- 종료 시간: 타임트리 이벤트 종료 시간
- 타입: "타임트리"
- 설명: 타임트리 이벤트 설명
- 주소: 타임트리 이벤트 위치
- 색상: 타임트리 이벤트 색상

## 주의사항

1. **중복 방지**: 타임트리에서 가져온 일정은 `createdBy: 'timetree_sync'`로 표시되어 중복 동기화를 방지합니다.

2. **권한 관리**: 타임트리 API 권한이 필요합니다:
   - `events_read`: 일정 읽기 권한
   - `events_write`: 일정 쓰기 권한

3. **토큰 관리**: 액세스 토큰은 자동으로 갱신되며, localStorage에 안전하게 저장됩니다.

4. **에러 처리**: 네트워크 오류나 권한 오류 시 적절한 에러 메시지가 표시됩니다.

## 문제 해결

### 인증 오류
- 타임트리 개발자 포털에서 Client ID와 Secret 확인
- Redirect URI가 정확히 설정되었는지 확인
- 브라우저 팝업 차단 해제

### 동기화 오류
- 타임트리 API 서버 상태 확인
- 네트워크 연결 상태 확인
- 선택한 캘린더에 대한 권한 확인

### 데이터 불일치
- 동기화 방향 설정 확인
- 중복 일정 확인
- 시간대 설정 확인

## 기술 스택

- **Frontend**: React, TypeScript, Material-UI
- **API**: 타임트리 REST API
- **인증**: OAuth 2.0
- **저장소**: localStorage (설정 및 토큰)

## 라이선스

이 기능은 타임트리 API를 사용하며, 타임트리의 이용약관을 준수해야 합니다. 